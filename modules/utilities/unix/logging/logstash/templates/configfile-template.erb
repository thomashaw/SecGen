input {
  beats {
    port => <%= @logstash_port-%>
  }
}

filter {
  mutate {
    add_field => { "combined_path" => "%{[process][cwd]}/%{[file][path]}" }
  }
  ruby {
    path => "/etc/logstash/combined_path.rb"
  }
}

output {
  elasticsearch {
    hosts => "<%= @elasticsearch_ip-%>:<%= @elasticsearch_port-%>"
    manage_template => false
    index => "%{[@metadata][beat]}-%{+YYYY.MM.dd}"
    document_type => "%{[@metadata][type]}"
  }
  stdout { codec => rubydebug }
}